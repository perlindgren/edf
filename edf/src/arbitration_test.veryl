#[test(arbitration)]
embed (inline) sv{{{

    module test;
        import edf_Types::*;

        IntVec i_int_vec; 
        DeadLine i_now;
        TreeItem o_item;

        int now;

        edf_Arbitration dut (
            .i_int_vec,
            .i_now(now[7:0]),
            .o_item
        );

        task tick (int x);
            # x;
		    now = now + x;
	    endtask

        function void pend(logic [2:0] i, logic signed [8-1:0] dl);
            $display("i ", i);
            i_int_vec[i].abs_dl = now[7:0] + dl;
            i_int_vec[i].pend = 1;
            i_int_vec[i].enable = 1;

            $display("abs_dl ", i_int_vec[i].abs_dl);
            $display("pend ", i_int_vec[i].pend);
        endfunction

        initial begin
           //  i_pend = '{default: 0}; 
            now = 0;
            
            tick(10);
            pend(0, 10);

            tick(10);
            
            tick(10);
            pend(1, 20);

            tick(10);
        end
    endmodule
}}}
